\documentclass{article}

\usepackage{fontspec}
%\setmainfont[Mapping=tex-text]{AR PL UMing TW}
\setmainfont[Mapping=tex-text]{文泉驛正黑}
\XeTeXlinebreaklocale ``zh''
\XeTeXlinebreakskip = 0pt plus 1pt

\usepackage{amsmath}

\def\tac{\textasciicircum}
\title{瑲珩}
\author{王湘叡}

\begin{document}
\maketitle{}

在開始之前，讓我們先考慮漢字的``筆劃數''這個屬性。%
假設要計算``曉''這個字的筆劃數，%
一個方式是一筆劃一筆劃地去寫出這個字，同時計數，最後得到十六劃。%
但另一個方法則是：\\
考慮到\\
\[
  \mbox{``曉''}=\mbox{``日''}+\mbox{``堯''}
\]
如果事先已經知道``日''為四劃及``堯''為十二劃，則只要用運算就可得到十六劃。
然而，問題是：要怎麼才可以事先知道``日''、``堯''的筆劃數呢？
看起來，似乎還是要一筆劃一筆劃去地去計算。
但我們一樣可以使用類似的方式。
考慮到\\
\[
  \mbox{``堯''}=\mbox{``垚''}+\mbox{``兀''}
\]
也就是如果事先已經知道``垚''為九劃和``兀''為三劃，則要用加法就可得到十二劃。
於是，問題變成：要怎麼才可以事先知道``垚''、``兀''的筆劃數呢？
若要計算``垚''、``兀''的筆劃，一樣要一筆一筆去算
對於``垚''，考慮到\\
\[
  \mbox{``垚''}=\mbox{``土''}\times 3
\]
也就是，如果事先已經知道``土''為三劃，則只要用乘法就可得到``垚''為九劃。
於是，最後的問題變成：要怎麼才可以事先知道``土''、``兀''和``日''的筆劃數呢？
這沒有其它方法，只能用一筆劃一筆劃去地去計算。

也就是說：只要我們用一筆劃一筆劃地去計算``土''、``兀''和``日''的筆劃數，
我們就可以計算出``曉''的筆劃。
看起來，這個方法未必會比一筆劃一筆劃地去計算``曉''的筆劃數來得快，
（因為還是要一筆劃一筆劃地去計算``土''、``兀''和``日''的筆劃數，且還要做一些加法或乘法運算）。
表面上是如此，但這是在``只計算一個字的筆劃數''的情況下才是如此。
如果現在的情況是``要計算一堆字的筆劃數''，
考量到很多部件在中文字是時常出現的，如``土''、``日''等，
也就是，如果只要能事先算出來，就可以省下很多功夫。

如果我們將類似的原理套用在輸入法上：
只要我們事先計算一些基本或不易分割的部件的外碼（字碼），
並在結合部件時，採用一定的方式去組合外碼，就可以算出那個字的外碼。
我們就可以省下大量的功夫，甚至是用電腦來計算。
%``曉''=``日''+``堯''\\
%``堯''=``垚''+``兀''\\
%``垚''=``土''+``土''+``土''\\
%%``土''，``日''，``垚''，``堯''，``曉''，''兀''
%%``土''，``垚''，``堯''，``曉''，``兀''

\section{行列、大易}
行列、大易的規則皆為前三後一。

同樣也是以``曉''為例。
\begin{tabular}{llll}
字  & 行列碼 & 大易碼\\
日  & P(0\tac) & D\\
土  & R(4\tac) & F\\
垚  & RRR(4\tac4\tac4\tac) & FFF\\
兀  & AS(1-2-) & EQ\\
堯  & RRRS(4\tac4\tac4\tac2-) & FFFQ\\
曉  & PRRS(0\tac4\tac4\tac2-) & DFFQ\\
\end{tabular}

如果用``.行''和``.易''來表示一個字的行列碼和大易碼，
且 $(\mbox{丙}=\mbox{甲}+\mbox{乙})$
我們可以用
\begin{subequations}
  \begin{align}
  \mbox{丙}_{\mbox{行}}&=\mbox{取前三後一}(\mbox{甲}_{\mbox{行}}+\mbox{乙}_{\mbox{行}})\\
  \mbox{丙}_{\mbox{易}}&=\mbox{取前三後一}(\mbox{甲}_{\mbox{易}}+\mbox{乙}_{\mbox{易}})
  \end{align}
\end{subequations}
來計算

\section{嘸蝦米}
嘸蝦米的規則亦為前三後一，但不同的是，嘸蝦米多了一個補碼規定
－－若取碼不足兩碼，則要根據最後一筆劃添加補碼。
為此，為嘸蝦米添加一個屬性：
用``嘸''、``.嘸補'' 表示一個字的嘸蝦米碼和補碼，
函數``\mbox{補}(X, Y)'' 則會根據 $X$ 的長度是否小於等於二碼來決定是否附加 $Y$
則
\begin{subequations}
  \begin{align}
  \mbox{丙}_{\mbox{嘸補}}&=\mbox{乙}_{\mbox{嘸補}}\\
  \mbox{丙}_{\mbox{嘸}}&=\mbox{補}(\mbox{取前三後一}(\mbox{甲}_{\mbox{嘸}}+\mbox{乙}_{\mbox{嘸}}),
                          \mbox{丙}_{\mbox{嘸補}})
  \end{align}
\end{subequations}
\section{倉頡}
倉頡的規則分為整體字和組合字。
整體字若不足四碼則全取，否則取首、二、三、末碼。
若為組合字，
``倉本''表示當成本字的倉頡碼。
``倉部''表示當成部件的倉頡碼。

\begin{subequations}
  \begin{align}
  \mbox{丙}_{\mbox{倉本}}&=\mbox{首尾}(\mbox{甲}_{\mbox{倉部}})
      + \mbox{首二尾}({\mbox{乙}_{\mbox{倉部}}})\\
  \mbox{丙}_{\mbox{倉部}}&= \mbox{首二尾}(
      \mbox{首尾}(\mbox{甲}_{\mbox{倉部}})
      + \mbox{首尾}(\mbox{甲}_{\mbox{倉部}})
      )
  \end{align}
\end{subequations}

\section{鄭碼}
鄭碼的規則
鄭碼的部件大多為二碼字，對一些常用的部件則為一碼
在少數的情況下，有三碼。
首碼稱為區碼，其餘稱為位碼。並依不同的情況，可以省略一些部件或位碼。
須要計算部件數，並依其個數，來決定規則。

\begin{tabular}{llll}
           & 首根 & 規則 & 例字\\
  二基根字 & \\
  三基根字 & \\
  四基根字 & \\
\end{tabular}
``鄭''表示一個字的鄭碼。
``鄭根串''表示一個字的字根串列。
``鄭根數''表示一個字可以拆成幾個字個。
``鄭首''表示一個字首個字根的碼數。

\begin{subequations}
  \begin{align}
  \mbox{丙}_{\mbox{鄭根串}} &= \mbox{甲}_{\mbox{鄭根串}} + \mbox{乙}_{\mbox{鄭根串}} \\
%  \mbox{丙}_{\mbox{鄭根數}} &= \max(4, \mbox{甲}_{\mbox{鄭根}} + \mbox{乙}_{\mbox{鄭根}} )\\
  \mbox{丙}_{\mbox{鄭根數}} &= \max(4, \mbox{丙}_{\mbox{鄭根數}} )\\
  \mbox{丙}_{\mbox{鄭首}} &= \mbox{甲}_{\mbox{鄭首}}\\
  \mbox{丙}_{\mbox{鄭}} &= \mbox{丙}_{\mbox{鄭根串}}[0][0:2]+\mbox{丙}_{\mbox{鄭根串}}[-1][:]
      if \mbox{丙}_{\mbox{鄭根數}}==2 \\
  \mbox{丙}_{\mbox{鄭}} &=
      \mbox{丙}_{\mbox{鄭根串}}[0][0:2]
      +\mbox{丙}_{\mbox{鄭根串}}[-2][-1]
      +\mbox{丙}_{\mbox{鄭根串}}[-1][-1]
      if \mbox{丙}_{\mbox{鄭根數}}==3 and \mbox{丙}_{\mbox{鄭首}}==2 \\
  \mbox{丙}_{\mbox{鄭}} &=
      \mbox{丙}_{\mbox{鄭根串}}[0][0]
      +\mbox{丙}_{\mbox{鄭根串}}[-2][-1]
      +\max(2, \mbox{丙}_{\mbox{鄭根串}}[-1][:])
      if \mbox{丙}_{\mbox{鄭根數}}==3 and \mbox{丙}_{\mbox{鄭首}}==1 \\
  \mbox{丙}_{\mbox{鄭}} &= \mbox{丙}_{\mbox{鄭根串}}[0][0]
      + \mbox{丙}_{\mbox{鄭根串}}[2][0]
      + \mbox{丙}_{\mbox{鄭根串}}[-2][0]
      + \mbox{丙}_{\mbox{鄭根串}}[-1][0]
      if \mbox{丙}_{\mbox{鄭根數}}==4 and \mbox{丙}_{\mbox{鄭首}}==1\\
  \mbox{丙}_{\mbox{鄭}} &= \mbox{丙}_{\mbox{鄭根串}}[0][0:2]
      + \mbox{丙}_{\mbox{鄭根串}}[-2][0]
      + \mbox{丙}_{\mbox{鄭根串}}[-1][0]
      if \mbox{丙}_{\mbox{鄭根數}}==4 and \mbox{丙}_{\mbox{鄭首}}==2\\
  \mbox{丙}_{\mbox{鄭}} &= \mbox{丙}_{\mbox{鄭根串}}[0][0:3]+\mbox{丙}_{\mbox{鄭根串}}[-1][:]
      if \mbox{丙}_{\mbox{鄭根數}}==4 and \mbox{丙}_{\mbox{鄭首}}==3\\
  \end{align}
\end{subequations}

\end{document}
